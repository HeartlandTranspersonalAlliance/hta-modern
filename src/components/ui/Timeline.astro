---
import { Icon } from 'astro-icon/components';
import { twMerge } from 'tailwind-merge';
import type { Item } from '~/types';

export interface Props {
  items?: Array<Item>;
  defaultIcon?: string;
  classes?: Record<string, string>;
}

const { items = [], classes = {}, defaultIcon } = Astro.props as Props;

const {
  container: containerClass = '',
  panel: panelClass = '',
  title: titleClass = '',
  description: descriptionClass = '',
  icon: defaultIconClass = 'text-primary',
} = classes;
---

{
  items && items.length > 0 && (
    <div class={containerClass}>
      {items.map(({ title, description, icon, classes: itemClasses = {} }, index = 0) => (
        <article
          class={twMerge(
            'relative pl-14 pb-8 intersect-once intersect-quarter motion-safe:md:opacity-0 motion-safe:md:intersect:animate-fade',
            panelClass,
            itemClasses?.panel
          )}
        >
          <div class="absolute left-0 top-0 flex flex-col items-center">
            <span class="flex w-10 h-10 items-center justify-center rounded-full bg-primary/12 dark:bg-primary/24 border border-primary/25">
              {(icon || defaultIcon) && (
                <Icon name={icon || defaultIcon} class={twMerge('w-5 h-5', defaultIconClass, itemClasses?.icon)} />
              )}
            </span>
            {index !== items.length - 1 && <span class="mt-2 block h-[calc(100%-2rem)] w-px bg-[var(--aw-border)]" />}
          </div>
          {title && (
            <p class={twMerge('text-lg font-semibold font-heading', titleClass, itemClasses?.title)} set:html={title} />
          )}
          {description && (
            <p
              class={twMerge('text-muted mt-2 leading-relaxed', descriptionClass, itemClasses?.description)}
              set:html={description}
            />
          )}
        </article>
      ))}
    </div>
  )
}
